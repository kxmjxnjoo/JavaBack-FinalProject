<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>Springfeed</title>
  </head>
  <body>
    <div id="root"></div>


    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">


  <script type="text/javascript" >

//메시지 표시
  function disappear() {
		document.getElementById("message").style.webkitTransform='translateY(-70px)';
	}
	
	function appear() {
		document.getElementById("message").style.webkitTransform='translateY(70px)';
		console.log(document.getElementById("message").value);
	}

//아이디 찾기
    function findIdCheck(event) {

      event.preventDefault()
      var formData = {
        name: $("#joinName").val(),
        phone: $("#joinPhone").val()
      };

      $.ajax({
        type: "POST",
        url: "/find/id",
        data: formData,
        dataType: "json",
        encode: true,
      }).done(function (data) {
        if(data.cnt == 1){
          result = confirm(data.message);
          if(result) {
            location.href="/"
          }
        } else {
          alert(data.message);
        }
      });
    };

//비밀번호 찾기    
    function findPwCheck(event) {

    event.preventDefault()
    var formData = {
      userid: $("#joinId").val(),
      phone: $("#joinPhone2").val(),
      email : $("#joinEmail").val()
    };

    $.ajax({
      type: "POST",
      url: "/find/pw",
      data: formData,
      dataType: "json",
      encode: true,
    }).done(function (data) {
      if(data.cnt == 1){
        result = confirm(data.message);
        if(result) {
          location.href="/"
        }
      } else {
        alert(data.message);
      }
    });
    };

//회원정보 수정
    function withdraw() {
			if(confirm("정말로 계정을 비활성화 할까요??")) {
				location.href = "/deleteAcount"
			}
		}
		
		function privateAccount() {
			if(confirm("계정을 비공개로 전환 할까요?")) {
				location.href = "/user/private"
			}
		}
		
		function publicAccount() {
			if(confirm("계정을 공개로 전환 할까요?")) {
				location.href = "/user/public"
			}
		}



//스토리(포스트) js
  //다시작성
    function reset(){
      let elem = document.querySelector("div#image_container img");
      elem.parentNode.removeChild(elem);
    }

  //썸네일 출력 js
    function setThumbnail(event) { 
      var reader = new FileReader(); 
      reader.onload = function(event) { 
        var img = document.createElement("img"); 
        img.setAttribute("src", event.target.result); 
        document.querySelector("div#image_container").appendChild(img); 
      }; 
    
      reader.readAsDataURL(event.target.files[0]); 
    }

  //스토리 작성 확인
      function uploadCheck(){
        var theForm = document.frm;
        if( theForm.story_img.value=="") {
          alert('사진을 첨부해주세요'); 
          return;
        } else {
          theForm.action="/story/add";
          theForm.submit();
        }
      }

  //이미지 업로드 ajax
      function uploadImg(){
          var formdata = new FormData($("#imgForm")[0]);   // 전송용 폼객에 다시 저장
          
          $.ajax({
            url:"/uploadImg",
            type:"POST",
            enctype:"multipart/form-data",
            async: false,
            data: formdata,
              timeout: 10000,
              contentType : false,
                processData : false,
                success : function(data){
                    if(data.STATUS == 1){
                      
                      $("#newImage").val(data.FILENAME);
                      console.log('newImage Change : ' + data.FILENAME)

                    }
                },
                error: function() {
              alert("실패");
            }
          });
        }

  //이미지 수정
      function resetImg(){
          let elem = document.querySelector("div#image_container img");
          elem.parentNode.removeChild(elem);
      }


//로그인 ajax
          
      function loginCheck(event) {

        event.preventDefault()
        var formData = {
          userid: $("#userid").val(),
          password: $("#password").val()
        };

        $.ajax({
          type: "POST",
          url: "/login",
          data: formData,
          dataType: "json",
          encode: true,
        }).done(function (data) {
          if(data == 1){
          location.href="/";
          } else {
            alert('다시 로그인하세요')
          }
        });
      };
      
      function checkId(){
          var id = $('#joinId').val(); //id값이 "id"인 입력란의 값을 저장
          $.ajax({
              url:'/join/idCheck', //Controller에서 인식할 주소
              type:'post', //POST 방식으로 전달
              data:{userid:id},
              success:function(cnt){
                  if(cnt != 1) {
                    $('#id_box #id_ok').css("display", "inline-block");
                    $('#id_box #id_already').css("display", "none");
                  } else {
                    $('#id_box #id_already').css("display", "inline-block");
                    $('#id_box #id_ok').css("display", "none");
                  }
              },
              error:function(){
                  alert("에러입니다");
              }
          });
      };
      
      function checkPhone(){
          var phone = $('#joinPhone').val(); //id값이 "id"인 입력란의 값을 저장
          $.ajax({
              url:'/join/idCheck', //Controller에서 인식할 주소
              type:'post', //POST 방식으로 전달
              data:{phone:phone},
              success:function(cnt){
                  console.log("처리 성공");
                  if(cnt != 1) {
                    $('#phone_box #id_ok').css("display", "inline-block");
                    $('#phone_box #id_already').css("display", "none");
                  } else {
                    $('#phone_box #id_already').css("display", "inline-block");
                    $('#phone_box #id_ok').css("display", "none");
                  }
              },
              error:function(){
                  alert("에러입니다");
              }
          });
      };
      
      function checkEmail(){
          var email = $('#joinEmail').val(); //id값이 "id"인 입력란의 값을 저장
          $.ajax({
              url:'/join/idCheck', //Controller에서 인식할 주소
              type:'post', //POST 방식으로 전달
              data:{email:email},
              success:function(cnt){
                  console.log("처리 성공");
                  if(cnt != 1) {
                    $('#email_box #id_ok').css("display", "inline-block");
                    $('#email_box #id_already').css("display", "none");
                  } else {
                    $('#email_box #id_already').css("display", "inline-block");
                    $('#email_box #id_ok').css("display", "none");
                  }
              },
              error:function(){
                  alert("에러입니다");
              }
          });
      };
      
      function checkPwd(){
          var pwd = $('#joinPwd').val(); //id값이 "id"인 입력란의 값을 저장
          $.ajax({
              url:'/join/idCheck', //Controller에서 인식할 주소
              type:'post', //POST 방식으로 전달
              data:{password:pwd},
              success:function(cnt){
                  console.log("처리 성공");
                  if(cnt != 1) {
                    $('#pwd_box #id_ok').css("display", "inline-block");
                    $('#pwd_box #id_already').css("display", "none");
                    $('#pwd_box #message').css("display", "none");
                  } else {
                    $('#pwd_box #id_already').css("display", "inline-block");
                    $('#pwd_box #message').css("display", "inline-block");
                    $('#pwd_box #id_ok').css("display", "none");
                  }
              },
              error:function(){
                  alert("에러입니다");
              }
          });
      };
      
      function checkName(){
          var name = $('#joinName').val(); //id값이 "id"인 입력란의 값을 저장
          $.ajax({
              url:'/join/idCheck', //Controller에서 인식할 주소
              type:'post', //POST 방식으로 전달
              data:{name:name},
              success:function(cnt){
                  console.log("처리 성공");
                  if(cnt != 1) {
                    $('#name_box #id_ok').css("display", "inline-block");
                    $('#name_box #id_already').css("display", "none");
                  } else {
                    $('#name_box #id_already').css("display", "inline-block");
                    $('#name_box #id_ok').css("display", "none");
                  }
              },
              error:function(){
                  alert("에러입니다");
              }
          });
      };
    </script>

    
  </body>
</html>
